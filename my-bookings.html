<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EventHub - My Bookings</title>

    <!-- Bootstrap 5.3 CSS (Latest) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <!-- Bootstrap Icons (Latest) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
    <!-- EventHub Header - Authenticated -->
    <nav class="navbar navbar-expand-lg eventhub-navbar">
        <div class="container-fluid px-4">
            <!-- Brand Logo -->
            <a class="navbar-brand eventhub-brand d-flex align-items-center" href="index.html">
                <div class="brand-icon me-2">
                    <i class="bi bi-calendar-event me-1"></i>
                </div>
                <span class="brand-text">EventHub</span>
            </a>

            <!-- Mobile Toggle Button -->
            <button class="navbar-toggler custom-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Navigation Items -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <!-- Left Navigation -->
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link eventhub-nav-link" href="index.html">
                            <i class="bi bi-house-fill me-1"></i>
                            Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link eventhub-nav-link" href="event-listing.html">
                            <i class="bi bi-calendar3 me-1"></i>Events
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link eventhub-nav-link active" href="my-bookings.html">
                            <i class="bi bi-ticket-perforated me-1"></i>My Bookings
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link eventhub-nav-link" href="my-tickets.html">
                            <i class="bi bi-qr-code me-1"></i>My Tickets
                        </a>
                    </li>
                </ul>

                <!-- Right Navigation - User Menu -->
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle user-menu" href="#" id="userDropdown" role="button" 
                           data-bs-toggle="dropdown" aria-expanded="false">
                            <div class="user-avatar">
                                <i class="bi bi-person-circle"></i>
                            </div>
                            <span class="user-name" id="userName">Priya Fernando</span>
                        </a>
                        <ul class="dropdown-menu user-dropdown" aria-labelledby="userDropdown">
                            <li><a class="dropdown-item" href="customer-dashboard.html">
                                <i class="bi bi-speedometer2 me-2"></i>Dashboard</a></li>
                            <li><a class="dropdown-item" href="user-profile.html">
                                <i class="bi bi-person me-2"></i>Edit Profile</a></li>
                            <li><a class="dropdown-item active" href="my-bookings.html">
                                <i class="bi bi-ticket-perforated me-2"></i>My Bookings</a></li>
                            <li><a class="dropdown-item" href="payment-history.html">
                                <i class="bi bi-credit-card me-2"></i>Payment History</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" onclick="logout()">
                                <i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="header-content">
                        <div class="header-info">
                            <h1 class="page-title">My Bookings</h1>
                            <p class="page-subtitle">View and manage all your event bookings</p>
                        </div>
                        <div class="header-stats">
                            <div class="stat-item">
                                <span class="stat-value" id="totalBookings">12</span>
                                <span class="stat-label">Total Bookings</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="upcomingCount">3</span>
                                <span class="stat-label">Upcoming</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="completedCount">9</span>
                                <span class="stat-label">Completed</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="bookings-content py-4">
        <div class="container-fluid">
            <div class="row">
                <!-- Filters & Search -->
                <div class="col-12 mb-4">
                    <div class="filters-card">
                        <div class="filters-header">
                            <h6 class="filters-title">Filter & Search</h6>
                            <button class="btn btn-sm btn-outline-secondary" onclick="clearFilters()">
                                <i class="bi bi-arrow-clockwise me-1"></i>Clear All
                            </button>
                        </div>
                        <div class="filters-content">
                            <div class="row g-3">
                                <div class="col-lg-3 col-md-6">
                                    <label class="form-label">Search Bookings</label>
                                    <div class="search-input">
                                        <i class="bi bi-search"></i>
                                        <input type="text" class="form-control" id="searchInput" 
                                               placeholder="Search by event name or booking ID">
                                    </div>
                                </div>
                                <div class="col-lg-2 col-md-6">
                                    <label class="form-label">Status</label>
                                    <select class="form-select" id="statusFilter">
                                        <option value="">All Status</option>
                                        <option value="confirmed">Confirmed</option>
                                        <option value="pending">Pending</option>
                                        <option value="cancelled">Cancelled</option>
                                        <option value="completed">Completed</option>
                                    </select>
                                </div>
                                <div class="col-lg-2 col-md-6">
                                    <label class="form-label">Date Range</label>
                                    <select class="form-select" id="dateFilter">
                                        <option value="">All Dates</option>
                                        <option value="upcoming">Upcoming</option>
                                        <option value="past">Past Events</option>
                                        <option value="this-month">This Month</option>
                                        <option value="next-month">Next Month</option>
                                    </select>
                                </div>
                                <div class="col-lg-2 col-md-6">
                                    <label class="form-label">Category</label>
                                    <select class="form-select" id="categoryFilter">
                                        <option value="">All Categories</option>
                                        <option value="music">Music</option>
                                        <option value="sports">Sports</option>
                                        <option value="arts">Arts & Culture</option>
                                        <option value="business">Business</option>
                                        <option value="food">Food & Drink</option>
                                        <option value="technology">Technology</option>
                                    </select>
                                </div>
                                <div class="col-lg-2 col-md-6">
                                    <label class="form-label">Sort By</label>
                                    <select class="form-select" id="sortFilter">
                                        <option value="date-desc">Event Date (Latest)</option>
                                        <option value="date-asc">Event Date (Earliest)</option>
                                        <option value="booking-desc">Booking Date (Recent)</option>
                                        <option value="booking-asc">Booking Date (Oldest)</option>
                                        <option value="amount-desc">Amount (High to Low)</option>
                                        <option value="amount-asc">Amount (Low to High)</option>
                                    </select>
                                </div>
                                <div class="col-lg-1 col-md-6 d-flex align-items-end">
                                    <button class="btn btn-primary w-100" onclick="applyFilters()">
                                        <i class="bi bi-funnel"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bookings List -->
                <div class="col-12">
                    <div class="bookings-container">
                        <!-- Tab Navigation -->
                        <div class="bookings-tabs">
                            <ul class="nav nav-tabs" id="bookingsTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="all-tab" data-bs-toggle="tab" 
                                            data-bs-target="#all" type="button" role="tab">
                                        <i class="bi bi-list-ul me-2"></i>All Bookings
                                        <span class="badge bg-secondary ms-2" id="allCount">12</span>
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="upcoming-tab" data-bs-toggle="tab" 
                                            data-bs-target="#upcoming" type="button" role="tab">
                                        <i class="bi bi-calendar-event me-2"></i>Upcoming
                                        <span class="badge bg-primary ms-2" id="upcomingBadge">3</span>
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="past-tab" data-bs-toggle="tab" 
                                            data-bs-target="#past" type="button" role="tab">
                                        <i class="bi bi-calendar-check me-2"></i>Past Events
                                        <span class="badge bg-success ms-2" id="pastCount">9</span>
                                    </button>
                                </li>
                            </ul>
                        </div>

                        <!-- Tab Content -->
                        <div class="tab-content" id="bookingsTabContent">
                            <!-- All Bookings Tab -->
                            <div class="tab-pane fade show active" id="all" role="tabpanel">
                                <div class="bookings-list" id="allBookingsList">
                                    <!-- Bookings will be loaded here -->
                                </div>
                            </div>

                            <!-- Upcoming Bookings Tab -->
                            <div class="tab-pane fade" id="upcoming" role="tabpanel">
                                <div class="bookings-list" id="upcomingBookingsList">
                                    <!-- Upcoming bookings will be loaded here -->
                                </div>
                            </div>

                            <!-- Past Bookings Tab -->
                            <div class="tab-pane fade" id="past" role="tabpanel">
                                <div class="bookings-list" id="pastBookingsList">
                                    <!-- Past bookings will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <style>

 /* EventHub Custom Styles */
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #f8fafc;
            line-height: 1.6;
        }

        /* Navbar Styling - Authenticated */
        .eventhub-navbar {
            background-color: #ffffff;
            border-bottom: 1px solid #e9ecef;
            padding: 0.75rem 0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .eventhub-brand {
            text-decoration: none;
            color: #6366f1 !important;
            font-weight: 700;
            font-size: 1.5rem;
        }

        .eventhub-brand:hover {
            color: #5855eb !important;
            text-decoration: none;
        }

        .brand-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .brand-text {
            color: #6366f1;
            font-weight: 700;
        }

        .eventhub-nav-link {
            color: #64748b !important;
            font-weight: 500;
            font-size: 0.95rem;
            padding: 0.5rem 1rem !important;
            margin: 0 0.25rem;
            border-radius: 8px;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
        }

        .eventhub-nav-link:hover {
            color: #6366f1 !important;
            background-color: rgba(99, 102, 241, 0.1);
        }

        .eventhub-nav-link.active {
            color: #6366f1 !important;
            background-color: rgba(99, 102, 241, 0.15);
            font-weight: 600;
        }

        /* User Menu */
        .user-menu {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem !important;
            border-radius: 50px;
            background: rgba(99, 102, 241, 0.1);
            color: #6366f1 !important;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .user-menu:hover {
            background: rgba(99, 102, 241, 0.15);
            color: #6366f1 !important;
        }

        .user-avatar {
            font-size: 1.5rem;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .user-dropdown {
            border-radius: 1rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            min-width: 220px;
        }

        .user-dropdown .dropdown-item {
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            margin-bottom: 0.25rem;
            transition: all 0.2s ease;
        }

        .user-dropdown .dropdown-item:hover {
            background-color: rgba(99, 102, 241, 0.1);
            color: #6366f1;
        }

        .user-dropdown .dropdown-item.active {
            background-color: rgba(99, 102, 241, 0.15);
            color: #6366f1;
            font-weight: 600;
        }

        .custom-toggler {
            border: none;
            padding: 0.25rem 0.5rem;
        }

        .custom-toggler:focus {
            box-shadow: 0 0 0 0.2rem rgba(99, 102, 241, 0.25);
        }

        /* Page Header */
        .page-header {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 2rem 0;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            flex-wrap: wrap;
            gap: 2rem;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            line-height: 1.2;
        }

        .page-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin: 0;
        }

        .header-stats {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.15);
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-value {
            display: block;
            font-size: 2rem;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Filters Card */
        .filters-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid #f1f5f9;
            overflow: hidden;
        }

        .filters-header {
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .filters-title {
            color: #374151;
            font-weight: 600;
            margin: 0;
        }

        .filters-content {
            padding: 1.5rem;
        }

        .search-input {
            position: relative;
        }

        .search-input i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            font-size: 0.9rem;
        }

        .search-input .form-control {
            padding-left: 2.5rem;
        }

        .form-label {
            color: #374151;
            font-weight: 500;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .form-control,
        .form-select {
            border: 2px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .form-control:focus,
        .form-select:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 0.2rem rgba(99, 102, 241, 0.15);
        }

        /* Bookings Container */
        .bookings-container {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid #f1f5f9;
            overflow: hidden;
        }

        /* Tabs */
        .bookings-tabs {
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
        }

        .nav-tabs {
            border-bottom: none;
            padding: 1rem 1.5rem 0;
        }

        .nav-tabs .nav-link {
            border: none;
            border-radius: 0.5rem 0.5rem 0 0;
            color: #64748b;
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            margin-right: 0.5rem;
            background: transparent;
            transition: all 0.3s ease;
        }

        .nav-tabs .nav-link:hover {
            background: rgba(99, 102, 241, 0.1);
            color: #6366f1;
            border-color: transparent;
        }

        .nav-tabs .nav-link.active {
            background: white;
            color: #6366f1;
            border-color: transparent;
            font-weight: 600;
        }

        .nav-tabs .badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
        }

        /* Bookings List */
        .bookings-list {
            padding: 1.5rem;
            min-height: 400px;
        }

        .booking-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .booking-item:hover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .booking-item:last-child {
            margin-bottom: 0;
        }

        .booking-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .booking-info {
            flex: 1;
        }

        .booking-id {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
            letter-spacing: 0.5px;
        }

        .event-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .event-details {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            color: #64748b;
            font-size: 0.9rem;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .detail-item i {
            color: #6366f1;
            font-size: 0.9rem;
        }

        .booking-status {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.5rem;
        }

        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 1.5rem;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.confirmed {
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .status-badge.pending {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .status-badge.cancelled {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .status-badge.completed {
            background: rgba(99, 102, 241, 0.1);
            color: #6366f1;
            border: 1px solid rgba(99, 102, 241, 0.3);
        }

        .booking-amount {
            font-size: 1.1rem;
            font-weight: 700;
            color: #374151;
        }

        .booking-body {
            border-top: 1px solid #e2e8f0;
            padding-top: 1rem;
            margin-top: 1rem;
        }

        .booking-tickets {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .ticket-summary {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            font-size: 0.9rem;
        }

        .ticket-type {
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.25rem;
        }

        .ticket-quantity {
            color: #64748b;
        }

        .booking-actions {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .booking-actions .btn {
            font-size: 0.85rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .booking-actions .btn:hover {
            transform: translateY(-1px);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: #64748b;
        }

        .empty-state i {
            font-size: 4rem;
            color: #e2e8f0;
            margin-bottom: 1.5rem;
        }

        .empty-state h5 {
            color: #374151;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .empty-state p {
            margin-bottom: 2rem;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Button Styles */
        .btn-primary {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border: none;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #5855eb 0%, #7c3aed 100%);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border: none;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            color: white;
        }

        .btn-outline-primary {
            border: 2px solid #6366f1;
            color: #6366f1;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-outline-primary:hover {
            background: #6366f1;
            color: white;
        }

        .btn-outline-secondary {
            border: 2px solid #6b7280;
            color: #6b7280;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-outline-secondary:hover {
            background: #6b7280;
            color: white;
        }

    .btn-outline-danger {
            border: 2px solid #ef4444;
            color: #ef4444;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-outline-danger:hover {
            background: #ef4444;
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 991.98px) {
            .navbar-collapse {
                margin-top: 1rem;
                padding: 1rem;
                background-color: white;
                border-radius: 12px;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                border: 1px solid #e2e8f0;
            }

            .eventhub-nav-link {
                padding: 0.75rem 1rem !important;
                margin: 0.25rem 0;
            }

            .user-menu {
                width: 100%;
                justify-content: center;
                margin-top: 1rem;
                border-top: 1px solid #e2e8f0;
                padding-top: 1rem !important;
            }

            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 1.5rem;
            }

            .header-stats {
                justify-content: center;
                gap: 1rem;
            }

            .page-title {
                font-size: 2rem;
            }

            .booking-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.75rem;
            }

            .booking-status {
                flex-direction: row;
                align-items: center;
                align-self: stretch;
                justify-content: space-between;
            }

            .event-details {
                flex-direction: column;
                gap: 0.75rem;
            }

            .booking-actions {
                flex-direction: column;
            }

            .booking-actions .btn {
                width: 100%;
            }

            .filters-content .row {
                --bs-gutter-x: 1rem;
            }
        }

        @media (max-width: 576px) {
            .page-header {
                padding: 1.5rem 0;
            }

            .page-title {
                font-size: 1.75rem;
            }

            .header-stats {
                width: 100%;
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 0.75rem;
            }

            .stat-item {
                padding: 0.75rem 1rem;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .filters-content {
                padding: 1rem;
            }

            .filters-content .col-lg-1 {
                order: -1;
                width: 100%;
            }

            .bookings-list {
                padding: 1rem;
            }

            .booking-item {
                padding: 1rem;
            }

            .nav-tabs {
                padding: 0.75rem 1rem 0;
            }

            .nav-tabs .nav-link {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }

            .empty-state {
                padding: 2rem 1rem;
            }

            .empty-state i {
                font-size: 3rem;
            }
        }

        /* Loading Animation */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 3rem;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e2e8f0;
            border-top: 4px solid #6366f1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.6s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-in {
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
    </style>

    <script>
        // Current user and bookings data
        let currentUser = null;
        let allBookings = [];
        let filteredBookings = [];

        // Sample bookings data - implementing Task 7 requirements
        const sampleBookings = [
            {
                bookingId: 'BK202512251234567',
                eventId: 1,
                eventTitle: 'Christmas Music Concert',
                eventDate: '2025-12-25',
                eventTime: '7:00 PM',
                eventVenue: 'BMICH, Colombo',
                eventCategory: 'music',
                eventImage: 'picture/event-concert.jpg',
                tickets: [
                    { type: 'VIP', quantity: 2, price: 5000 }
                ],
                totalAmount: 10500,
                bookingDate: '2024-12-01T10:30:00Z',
                status: 'confirmed',
                paymentMethod: 'card'
            },
            {
                bookingId: 'BK202512201234568',
                eventId: 4,
                eventTitle: 'Jazz Night Under Stars',
                eventDate: '2025-01-30',
                eventTime: '8:00 PM',
                eventVenue: 'Royal Botanical Gardens, Kandy',
                eventCategory: 'music',
                eventImage: 'picture/event-jazz.jpg',
                tickets: [
                    { type: 'Regular', quantity: 2, price: 2500 }
                ],
                totalAmount: 5500,
                bookingDate: '2024-12-15T14:20:00Z',
                status: 'confirmed',
                paymentMethod: 'card'
            },
            {
                bookingId: 'BK202511151234569',
                eventId: 2,
                eventTitle: 'Tech Innovation Summit 2025',
                eventDate: '2025-01-15',
                eventTime: '9:00 AM',
                eventVenue: 'Kandy City Center',
                eventCategory: 'business',
                eventImage: 'picture/event-tech.jpg',
                tickets: [
                    { type: 'Premium', quantity: 1, price: 7500 }
                ],
                totalAmount: 8000,
                bookingDate: '2024-11-10T09:15:00Z',
                status: 'confirmed',
                paymentMethod: 'bank'
            },
            {
                bookingId: 'BK202411051234570',
                eventId: 3,
                eventTitle: 'Colombo Food Festival',
                eventDate: '2024-11-20',
                eventTime: '11:00 AM',
                eventVenue: 'Galle Face Green',
                eventCategory: 'food',
                eventImage: 'picture/event-food.jpg',
                tickets: [
                    { type: 'Regular', quantity: 4, price: 1500 }
                ],
                totalAmount: 6500,
                bookingDate: '2024-11-01T16:45:00Z',
                status: 'completed',
                paymentMethod: 'paypal'
            },
            {
                bookingId: 'BK202410201234571',
                eventId: 5,
                eventTitle: 'Art Exhibition Opening',
                eventDate: '2024-11-05',
                eventTime: '6:00 PM',
                eventVenue: 'National Art Gallery',
                eventCategory: 'arts',
                eventImage: 'picture/event-art.jpg',
                tickets: [
                    { type: 'Regular', quantity: 2, price: 1000 }
                ],
                totalAmount: 2350,
                bookingDate: '2024-10-15T11:30:00Z',
                status: 'completed',
                paymentMethod: 'card'
            },
            {
                bookingId: 'BK202410101234572',
                eventId: 6,
                eventTitle: 'Business Networking Event',
                eventDate: '2024-10-25',
                eventTime: '7:00 PM',
                eventVenue: 'Hilton Colombo',
                eventCategory: 'business',
                eventImage: 'picture/event-business.jpg',
                tickets: [
                    { type: 'Premium', quantity: 1, price: 4000 }
                ],
                totalAmount: 4500,
                bookingDate: '2024-10-05T13:20:00Z',
                status: 'completed',
                paymentMethod: 'card'
            },
            {
                bookingId: 'BK202509151234573',
                eventId: 7,
                eventTitle: 'Sports Championship Finals',
                eventDate: '2024-10-15',
                eventTime: '3:00 PM',
                eventVenue: 'R. Premadasa Stadium',
                eventCategory: 'sports',
                eventImage: 'picture/event-sports.jpg',
                tickets: [
                    { type: 'Regular', quantity: 3, price: 2000 }
                ],
                totalAmount: 6500,
                bookingDate: '2024-09-10T08:45:00Z',
                status: 'completed',
                paymentMethod: 'bank'
            },
            {
                bookingId: 'BK202509051234574',
                eventId: 8,
                eventTitle: 'Wellness & Yoga Retreat',
                eventDate: '2024-09-28',
                eventTime: '6:00 AM',
                eventVenue: 'Mount Lavinia Beach',
                eventCategory: 'health',
                eventImage: 'picture/event-wellness.jpg',
                tickets: [
                    { type: 'Regular', quantity: 1, price: 2500 }
                ],
                totalAmount: 2850,
                bookingDate: '2024-08-20T19:10:00Z',
                status: 'completed',
                paymentMethod: 'paypal'
            },
            {
                bookingId: 'BK202412011234575',
                eventId: 9,
                eventTitle: 'Winter Music Festival',
                eventDate: '2025-02-14',
                eventTime: '5:00 PM',
                eventVenue: 'Viharamahadevi Park',
                eventCategory: 'music',
                eventImage: 'picture/event-music.jpg',
                tickets: [
                    { type: 'VIP', quantity: 2, price: 6000 }
                ],
                totalAmount: 12500,
                bookingDate: '2024-12-01T12:00:00Z',
                status: 'pending',
                paymentMethod: 'bank'
            },
            {
                bookingId: 'BK202411281234576',
                eventId: 10,
                eventTitle: 'Digital Marketing Workshop',
                eventDate: '2025-01-20',
                eventTime: '2:00 PM',
                eventVenue: 'Colombo City Center',
                eventCategory: 'business',
                eventImage: 'picture/event-workshop.jpg',
                tickets: [
                    { type: 'Regular', quantity: 1, price: 3500 }
                ],
                totalAmount: 4000,
                bookingDate: '2024-11-25T15:30:00Z',
                status: 'confirmed',
                paymentMethod: 'card'
            },
            {
                bookingId: 'BK202411201234577',
                eventId: 11,
                eventTitle: 'Photography Exhibition',
                eventDate: '2025-03-10',
                eventTime: '10:00 AM',
                eventVenue: 'Colombo National Museum',
                eventCategory: 'arts',
                eventImage: 'picture/event-photo.jpg',
                tickets: [
                    { type: 'Regular', quantity: 2, price: 800 }
                ],
                totalAmount: 1950,
                bookingDate: '2024-11-18T09:20:00Z',
                status: 'confirmed',
                paymentMethod: 'paypal'
            },
            {
                bookingId: 'BK202411101234578',
                eventId: 12,
                eventTitle: 'Startup Pitch Competition',
                eventDate: '2025-04-05',
                eventTime: '1:00 PM',
                eventVenue: 'Dialog Axiata Auditorium',
                eventCategory: 'business',
                eventImage: 'picture/event-startup.jpg',
                tickets: [
                    { type: 'Premium', quantity: 1, price: 5500 }
                ],
                totalAmount: 6000,
                bookingDate: '2024-11-08T17:45:00Z',
                status: 'confirmed',
                paymentMethod: 'card'
            }
        ];

        document.addEventListener('DOMContentLoaded', function () {
            initializeBookingsPage();
            loadUserData();
            loadBookingsData();
            setupEventListeners();
            setupFilters();
        });

        function initializeBookingsPage() {
            // Check if user is logged in
            const sessionData = localStorage.getItem('userSession') || sessionStorage.getItem('userSession');
            
            if (!sessionData) {
                window.location.href = 'login.html?redirect=my-bookings.html';
                return;
            }

            currentUser = JSON.parse(sessionData);
            
            if (currentUser.role !== 'customer') {
                Swal.fire({
                    title: 'Access Denied',
                    text: 'This page is only accessible to customers.',
                    icon: 'error',
                    confirmButtonColor: '#6366f1'
                }).then(() => {
                    window.location.href = 'login.html';
                });
                return;
            }
        }

        function loadUserData() {
            if (!currentUser) return;

            // Update user name in navbar
            document.getElementById('userName').textContent = currentUser.name;
        }

        function loadBookingsData() {
            // In real app, fetch from API. For demo, use sample data + any stored bookings
            const storedBookings = JSON.parse(localStorage.getItem('userBookings') || '[]');
            const bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
            
            // Combine all booking sources
            allBookings = [...sampleBookings, ...storedBookings, ...bookingHistory];
            
            // Remove duplicates by bookingId
            allBookings = allBookings.filter((booking, index, self) => 
                index === self.findIndex(b => b.bookingId === booking.bookingId)
            );

            // Sort by booking date (most recent first)
            allBookings.sort((a, b) => new Date(b.bookingDate) - new Date(a.bookingDate));

            filteredBookings = [...allBookings];
            
            displayBookings();
            updateStats();
        }

        function displayBookings() {
            const currentDate = new Date();
            
            // Categorize bookings
            const upcomingBookings = filteredBookings.filter(booking => new Date(booking.eventDate) > currentDate);
            const pastBookings = filteredBookings.filter(booking => new Date(booking.eventDate) <= currentDate);

            // Display in respective tabs
            displayBookingsList('allBookingsList', filteredBookings);
            displayBookingsList('upcomingBookingsList', upcomingBookings);
            displayBookingsList('pastBookingsList', pastBookings);

            // Update tab badges
            document.getElementById('allCount').textContent = filteredBookings.length;
            document.getElementById('upcomingBadge').textContent = upcomingBookings.length;
            document.getElementById('pastCount').textContent = pastBookings.length;
        }

        function displayBookingsList(containerId, bookings) {
            const container = document.getElementById(containerId);
            
            if (bookings.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="bi bi-ticket-perforated"></i>
                        <h5>No Bookings Found</h5>
                        <p>You don't have any bookings matching the current filters. Start exploring amazing events!</p>
                        <a href="event-listing.html" class="btn btn-primary">
                            <i class="bi bi-search me-2"></i>Discover Events
                        </a>
                    </div>
                `;
                return;
            }

            container.innerHTML = bookings.map((booking, index) => `
                <div class="booking-item fade-in" style="animation-delay: ${index * 0.1}s">
                    <div class="booking-header">
                        <div class="booking-info">
                            <div class="booking-id">Booking ID: ${booking.bookingId}</div>
                            <h3 class="event-title">${booking.eventTitle}</h3>
                            <div class="event-details">
                                <div class="detail-item">
                                    <i class="bi bi-calendar3"></i>
                                    <span>${formatEventDate(booking.eventDate)}</span>
                                </div>
                                <div class="detail-item">
                                    <i class="bi bi-clock"></i>
                                    <span>${booking.eventTime}</span>
                                </div>
                                <div class="detail-item">
                                    <i class="bi bi-geo-alt"></i>
                                    <span>${booking.eventVenue}</span>
                                </div>
                                <div class="detail-item">
                                    <i class="bi bi-calendar-plus"></i>
                                    <span>Booked: ${formatBookingDate(booking.bookingDate)}</span>
                                </div>
                            </div>
                        </div>
                        <div class="booking-status">
                            <span class="status-badge ${booking.status}">${getStatusText(booking.status)}</span>
                            <div class="booking-amount">Rs. ${booking.totalAmount.toLocaleString()}</div>
                        </div>
                    </div>
                    <div class="booking-body">
                        <div class="booking-tickets">
                            ${booking.tickets.map(ticket => `
                                <div class="ticket-summary">
                                    <div class="ticket-type">${ticket.type} Ticket</div>
                                    <div class="ticket-quantity">Quantity: ${ticket.quantity} Ã— Rs. ${ticket.price.toLocaleString()}</div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="booking-actions">
                            ${getBookingActions(booking)}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getBookingActions(booking) {
            const currentDate = new Date();
            const eventDate = new Date(booking.eventDate);
            const isUpcoming = eventDate > currentDate;
            const actions = [];

            // View Tickets - always available for confirmed bookings
            if (booking.status === 'confirmed' || booking.status === 'completed') {
                actions.push(`
                    <button class="btn btn-primary" onclick="viewTickets('${booking.bookingId}')">
                        <i class="bi bi-qr-code me-2"></i>View Tickets
                    </button>
                `);
            }

            // Download Tickets - for confirmed bookings
            if (booking.status === 'confirmed' || booking.status === 'completed') {
                actions.push(`
                    <button class="btn btn-outline-primary" onclick="downloadTickets('${booking.bookingId}')">
                        <i class="bi bi-download me-2"></i>Download
                    </button>
                `);
            }

            // Event Details - always available
            actions.push(`
                <button class="btn btn-outline-secondary" onclick="viewEventDetails(${booking.eventId})">
                    <i class="bi bi-info-circle me-2"></i>Event Details
                </button>
            `);

            // Cancel Booking - only for upcoming confirmed events
            if (isUpcoming && booking.status === 'confirmed') {
                const hoursTillEvent = (eventDate - currentDate) / (1000 * 60 * 60);
                if (hoursTillEvent > 48) { // Can cancel up to 48 hours before
                    actions.push(`
                        <button class="btn btn-outline-danger" onclick="cancelBooking('${booking.bookingId}')">
                            <i class="bi bi-x-circle me-2"></i>Cancel
                        </button>
                    `);
                }
            }

            // Payment Details - always available
            actions.push(`
                <button class="btn btn-outline-secondary" onclick="viewPaymentDetails('${booking.bookingId}')">
                    <i class="bi bi-receipt me-2"></i>Receipt
                </button>
            `);

            return actions.join('');
        }

        function getStatusText(status) {
            const statusMap = {
                'confirmed': 'Confirmed',
                'pending': 'Pending',
                'cancelled': 'Cancelled',
                'completed': 'Completed'
            };
            return statusMap[status] || status;
        }

        function formatEventDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                weekday: 'short',
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function formatBookingDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function updateStats() {
            const currentDate = new Date();
            const upcoming = allBookings.filter(b => new Date(b.eventDate) > currentDate);
            const completed = allBookings.filter(b => new Date(b.eventDate) <= currentDate && b.status === 'completed');

            document.getElementById('totalBookings').textContent = allBookings.length;
            document.getElementById('upcomingCount').textContent = upcoming.length;
            document.getElementById('completedCount').textContent = completed.length;
        }

        function setupEventListeners() {
            // Mobile menu auto-close
            const navLinks = document.querySelectorAll('.navbar-nav .nav-link');
            const navbarCollapse = document.querySelector('.navbar-collapse');

            navLinks.forEach(link => {
                link.addEventListener('click', function () {
                    if (window.innerWidth < 992) {
                        const bsCollapse = bootstrap.Collapse.getInstance(navbarCollapse) ||
                            new bootstrap.Collapse(navbarCollapse);
                        bsCollapse.hide();
                    }
                });
            });

            // Tab switching
            const tabButtons = document.querySelectorAll('#bookingsTabs button[data-bs-toggle="tab"]');
            tabButtons.forEach(button => {
                button.addEventListener('shown.bs.tab', function (event) {
                    // Refresh the current tab's booking list
                    const target = event.target.getAttribute('data-bs-target');
                    if (target === '#all') {
                        displayBookingsList('allBookingsList', filteredBookings);
                    } else if (target === '#upcoming') {
                        const upcoming = filteredBookings.filter(b => new Date(b.eventDate) > new Date());
                        displayBookingsList('upcomingBookingsList', upcoming);
                    } else if (target === '#past') {
                        const past = filteredBookings.filter(b => new Date(b.eventDate) <= new Date());
                        displayBookingsList('pastBookingsList', past);
                    }
                });
            });
        }

        function setupFilters() {
            // Search input
            document.getElementById('searchInput').addEventListener('input', function() {
                debounce(applyFilters, 300)();
            });

            // Filter dropdowns
            ['statusFilter', 'dateFilter', 'categoryFilter', 'sortFilter'].forEach(filterId => {
                document.getElementById(filterId).addEventListener('change', applyFilters);
            });
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const dateFilter = document.getElementById('dateFilter').value;
            const categoryFilter = document.getElementById('categoryFilter').value;
            const sortFilter = document.getElementById('sortFilter').value;

            filteredBookings = allBookings.filter(booking => {
                // Search filter
                const matchesSearch = !searchTerm || 
                    booking.eventTitle.toLowerCase().includes(searchTerm) ||
                    booking.bookingId.toLowerCase().includes(searchTerm) ||
                    booking.eventVenue.toLowerCase().includes(searchTerm);

                // Status filter
                const matchesStatus = !statusFilter || booking.status === statusFilter;

                // Date filter
                const matchesDate = filterByDate(booking, dateFilter);

                // Category filter
                const matchesCategory = !categoryFilter || booking.eventCategory === categoryFilter;

                return matchesSearch && matchesStatus && matchesDate && matchesCategory;
            });

            // Apply sorting
            applySorting(sortFilter);

            // Refresh display
            displayBookings();
        }

        function filterByDate(booking, filter) {
            if (!filter) return true;

            const bookingDate = new Date(booking.eventDate);
            const now = new Date();
            const thisMonth = new Date(now.getFullYear(), now.getMonth(), 1);
            const nextMonth = new Date(now.getFullYear(), now.getMonth() + 1, 1);

            switch (filter) {
                case 'upcoming':
                    return bookingDate > now;
                case 'past':
                    return bookingDate <= now;
                case 'this-month':
                    return bookingDate >= thisMonth && bookingDate < nextMonth;
                case 'next-month':
                    const nextMonthEnd = new Date(now.getFullYear(), now.getMonth() + 2, 1);
                    return bookingDate >= nextMonth && bookingDate < nextMonthEnd;
                default:
                    return true;
            }
        }

        function applySorting(sortType) {
            switch (sortType) {
                case 'date-desc':
                    filteredBookings.sort((a, b) => new Date(b.eventDate) - new Date(a.eventDate));
                    break;
                case 'date-asc':
                    filteredBookings.sort((a, b) => new Date(a.eventDate) - new Date(b.eventDate));
                    break;
                case 'booking-desc':
                    filteredBookings.sort((a, b) => new Date(b.bookingDate) - new Date(a.bookingDate));
                    break;
                case 'booking-asc':
                    filteredBookings.sort((a, b) => new Date(a.bookingDate) - new Date(b.bookingDate));
                    break;
                case 'amount-desc':
                    filteredBookings.sort((a, b) => b.totalAmount - a.totalAmount);
                    break;
                case 'amount-asc':
                    filteredBookings.sort((a, b) => a.totalAmount - b.totalAmount);
                    break;
                default:
                    // Default: booking date desc
                    filteredBookings.sort((a, b) => new Date(b.bookingDate) - new Date(a.bookingDate));
            }
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('dateFilter').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('sortFilter').value = 'date-desc';
            
            applyFilters();
        }

        // Booking Action Functions
        function viewTickets(bookingId) {
            window.location.href = `my-tickets.html?booking=${bookingId}`;
        }

        function downloadTickets(bookingId) {
            Swal.fire({
                title: 'Preparing Download...',
                text: 'Your tickets are being prepared for download.',
                icon: 'info',
                showConfirmButton: false,
                timer: 2000,
                timerProgressBar: true
            }).then(() => {
                Swal.fire({
                    title: 'Download Ready!',
                    text: 'Your PDF tickets have been generated.',
                    icon: 'success',
                    confirmButtonColor: '#6366f1'
                });
            });
        }

        function viewEventDetails(eventId) {
            window.location.href = `event-details.html?id=${eventId}`;
        }

        function cancelBooking(bookingId) {
            const booking = allBookings.find(b => b.bookingId === bookingId);
            if (!booking) return;

            Swal.fire({
                title: 'Cancel Booking?',
                html: `
                    <div class="text-start">
                        <p><strong>Event:</strong> ${booking.eventTitle}</p>
                        <p><strong>Date:</strong> ${formatEventDate(booking.eventDate)}</p>
                        <p><strong>Amount:</strong> Rs. ${booking.totalAmount.toLocaleString()}</p>
                        <hr>
                        <p class="text-warning"><strong>Note:</strong> Cancellation fee may apply. Refunds will be processed within 5-7 business days.</p>
                    </div>
                `,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Yes, Cancel Booking',
                cancelButtonText: 'Keep Booking',
                confirmButtonColor: '#ef4444',
                cancelButtonColor: '#6366f1'
            }).then((result) => {
                if (result.isConfirmed) {
                    // Update booking status
                    booking.status = 'cancelled';
                    
                    // Update in storage
                    updateBookingInStorage(booking);
                    
                    // Refresh display
                    loadBookingsData();
                    
                    Swal.fire({
                        title: 'Booking Cancelled',
                        text: 'Your booking has been cancelled successfully. Refund will be processed within 5-7 business days.',
                        icon: 'success',
                        confirmButtonColor: '#6366f1',
                        timer: 3000,
                        timerProgressBar: true
                    });
                }
            });
        }

        function viewPaymentDetails(bookingId) {
            const booking = allBookings.find(b => b.bookingId === bookingId);
            if (!booking) return;

            const paymentMethods = {
                card: 'Credit/Debit Card',
                paypal: 'PayPal',
                bank: 'Bank Transfer'
            };

            Swal.fire({
                title: 'Payment Receipt',
                html: `
                    <div class="text-start">
                        <div class="mb-3">
                            <strong>Booking ID:</strong> ${booking.bookingId}<br>
                            <strong>Event:</strong> ${booking.eventTitle}<br>
                            <strong>Payment Method:</strong> ${paymentMethods[booking.paymentMethod] || booking.paymentMethod}
                        </div>
                        <hr>
                        <div class="mb-3">
                            ${booking.tickets.map(ticket => `
                                <div class="d-flex justify-content-between">
                                    <span>${ticket.type} Ã— ${ticket.quantity}</span>
                                    <span>Rs. ${(ticket.price * ticket.quantity).toLocaleString()}</span>
                                </div>
                            `).join('')}
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between">
                            <strong>Total Amount:</strong>
                            <strong>Rs. ${booking.totalAmount.toLocaleString()}</strong>
                        </div>
                    </div>
                `,
                icon: 'info',
                confirmButtonText: 'Close',
                confirmButtonColor: '#6366f1',
                showCancelButton: true,
                cancelButtonText: 'Download Receipt',
                cancelButtonColor: '#10b981'
            }).then((result) => {
                if (result.dismiss === Swal.DismissReason.cancel) {
                    // Simulate receipt download
                    Swal.fire({
                        title: 'Receipt Downloaded',
                        text: 'Your payment receipt has been downloaded.',
                        icon: 'success',
                        confirmButtonColor: '#6366f1',
                        timer: 2000,
                        timerProgressBar: true
                    });
                }
            });
        }

        function updateBookingInStorage(booking) {
            // Update in userBookings if it exists there
            let userBookings = JSON.parse(localStorage.getItem('userBookings') || '[]');
            const userBookingIndex = userBookings.findIndex(b => b.bookingId === booking.bookingId);
            if (userBookingIndex !== -1) {
                userBookings[userBookingIndex] = booking;
                localStorage.setItem('userBookings', JSON.stringify(userBookings));
            }

            // Update in bookingHistory if it exists there
            let bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
            const historyIndex = bookingHistory.findIndex(b => b.bookingId === booking.bookingId);
            if (historyIndex !== -1) {
                bookingHistory[historyIndex] = booking;
                localStorage.setItem('bookingHistory', JSON.stringify(bookingHistory));
            }
        }

        function logout() {
            Swal.fire({
                title: 'Sign Out',
                text: 'Are you sure you want to sign out?',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: 'Yes, Sign Out',
                cancelButtonText: 'Cancel',
                confirmButtonColor: '#ef4444'
            }).then((result) => {
                if (result.isConfirmed) {
                    // Clear session data
                    localStorage.removeItem('userSession');
                    sessionStorage.removeItem('userSession');
                    localStorage.removeItem('userLoggedIn');
                    localStorage.removeItem('userName');
                    localStorage.removeItem('userRole');
                    
                    // Show success message
                    Swal.fire({
                        title: 'Signed Out Successfully',
                        text: 'You have been signed out of your account.',
                        icon: 'success',
                        timer: 2000,
                        timerProgressBar: true,
                        showConfirmButton: false
                    }).then(() => {
                        window.location.href = 'index.html';
                    });
                }
            });
        }

        // Auto-refresh booking status for pending bookings
        function autoRefreshPendingBookings() {
            const pendingBookings = allBookings.filter(b => b.status === 'pending');
            
            if (pendingBookings.length > 0) {
                // Simulate some pending bookings becoming confirmed
                pendingBookings.forEach(booking => {
                    if (Math.random() < 0.1) { // 10% chance every minute
                        booking.status = 'confirmed';
                        updateBookingInStorage(booking);
                        
                        // Show notification
                        Swal.fire({
                            title: 'Booking Confirmed!',
                            text: `Your booking for ${booking.eventTitle} has been confirmed.`,
                            icon: 'success',
                            timer: 4000,
                            timerProgressBar: true,
                            position: 'top-end',
                            toast: true,
                            showConfirmButton: false
                        });
                        
                        // Refresh display
                        loadBookingsData();
                    }
                });
            }
        }

        // Check for pending bookings every minute
        setInterval(autoRefreshPendingBookings, 60000);

        // Export bookings functionality
        function exportBookings() {
            const csvContent = generateBookingsCSV();
            downloadCSV(csvContent, 'my-bookings.csv');
        }

        function generateBookingsCSV() {
            const headers = ['Booking ID', 'Event Title', 'Event Date', 'Venue', 'Status', 'Total Amount', 'Booking Date'];
            const rows = allBookings.map(booking => [
                booking.bookingId,
                booking.eventTitle,
                booking.eventDate,
                booking.eventVenue,
                booking.status,
                booking.totalAmount,
                new Date(booking.bookingDate).toLocaleDateString()
            ]);

            return [headers, ...rows].map(row => row.join(',')).join('\n');
        }

        function downloadCSV(content, filename) {
            const blob = new Blob([content], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Add export button to header
        document.addEventListener('DOMContentLoaded', function() {
            const headerStats = document.querySelector('.header-stats');
            if (headerStats) {
                const exportButton = document.createElement('button');
                exportButton.className = 'btn btn-outline-light btn-sm';
                exportButton.onclick = exportBookings;
                exportButton.innerHTML = '<i class="bi bi-download me-2"></i>Export';
                headerStats.appendChild(exportButton);
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + F to focus search
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                e.preventDefault();
                document.getElementById('searchInput').focus();
            }
            
            // Ctrl/Cmd + R to refresh bookings
            if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                e.preventDefault();
                loadBookingsData();
                
                Swal.fire({
                    title: 'Bookings Refreshed',
                    icon: 'success',
                    timer: 1500,
                    timerProgressBar: true,
                    position: 'top-end',
                    toast: true,
                    showConfirmButton: false
                });
            }
        });

        // Add refresh button functionality
        function refreshBookings() {
            // Show loading state
            const containers = ['allBookingsList', 'upcomingBookingsList', 'pastBookingsList'];
            containers.forEach(id => {
                document.getElementById(id).innerHTML = `
                    <div class="loading">
                        <div class="loading-spinner"></div>
                    </div>
                `;
            });

            // Simulate API call delay
            setTimeout(() => {
                loadBookingsData();
                
                Swal.fire({
                    title: 'Bookings Updated',
                    text: 'Your bookings have been refreshed with the latest information.',
                    icon: 'success',
                    timer: 2000,
                    timerProgressBar: true,
                    position: 'top-end',
                    toast: true,
                    showConfirmButton: false
                });
            }, 1000);
        }

        // Add refresh button to filters
        document.addEventListener('DOMContentLoaded', function() {
            const clearButton = document.querySelector('.filters-header .btn');
            if (clearButton) {
                const refreshButton = document.createElement('button');
                refreshButton.className = 'btn btn-sm btn-primary me-2';
                refreshButton.onclick = refreshBookings;
                refreshButton.innerHTML = '<i class="bi bi-arrow-clockwise me-1"></i>Refresh';
                clearButton.parentNode.insertBefore(refreshButton, clearButton);
            }
        });
    </script>
        <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>

</body>
</html>

    
       